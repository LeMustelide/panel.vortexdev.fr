{% extends "base.html.twig" %}

{% block title %}
	Journal - panel
{% endblock %}

{% block javascripts %}


	<script type="text/javascript" src="{{ asset('Js/keys.js') }}"></script>


	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js" type="text/javascript"></script>


{% endblock %}

{% block content %}
	<div class="container-fluid">
		<h3 class="text-dark mb-4" style="/*border-color: rgb(251,0,0);*/">Journaux d'Événements</h3>
		<div class="card shadow">
			<div class="card-header d-flex justify-content-between align-items-center">
				<h6 class="text-primary fw-bold m-0">Clés générées</h6>
				<div class="dropdown no-arrow">
					<button class="btn btn-link btn-sm dropdown-toggle" aria-expanded="false" data-bs-toggle="dropdown" type="button">
						<i class="far fa-eye-slash text-gray-400"></i>
					</button>
					<div class="dropdown-menu shadow dropdown-menu-end animated--fade-in" style="/*background: rgb(64,63,63);*/"></div>
				</div>
			</div>
			<div class="card-body">
				<div class="row">
					<div class="col-md-6 text-nowrap">
                        <div id="dataTable_status" class="dataTable_status" aria-controls="dataTable">
                            <label class="form-label">Status :
                                <select class="d-inline-block form-select form-select-sm" style="width: 90px;" onchange="window.location.href='/log/'+this.value+'/{{ page }}'">
                                    <option value="pass" {% if size == 10 %} selected {% endif %}>pass</option>
                                    <option value="fail" {% if size == 25 %} selected {% endif %}>fail</option>
                                </select>
                            </label>
						</div>
					</div>
					<div class="col-md-6">
						<div class="text-md-end dataTables_filter" id="dataTable_filter">
							<button onclick="openFormAdd()" class="btn btn-primary addbuton" type="button">
								<i class="fas fa-plus"></i>
							</button>
							<label class="form-label"><input type="search" class="form-control form-control-sm" aria-controls="dataTable" placeholder="Rechercher"></label>
						</div>
					</div>
				</div>
				<div class="table-responsive table mt-2" id="dataTable" role="grid" aria-describedby="dataTable_info">
					<table class="table my-0" id="dataTable">
						<thead>
							<tr>
								<th style="width: 10%;"><a {% if sort != 'action' %} href="/log/{{ page }}/action" {% elseif sort != 'naction' %} href="/log/{{ page }}/naction" {% endif %}>Action</a>{% if sort == 'action' %} <i class="fas fa-arrow-up"></i> {% elseif sort == 'naction' %}<i class="fas fa-arrow-down"></i> {% endif %} </th>
								<th style="width: 20%;">Steam ID</th>
								<th style="width: 35%;">Contenu</th>
								<th style="min-width: 10%;"><a {% if sort != 'date' %} href="/log/{{ page }}/date" {% elseif sort != 'ndate' %} href="/log/{{ page }}/ndate" {% endif %}>Date</a>{% if sort == 'date' %} <i class="fas fa-arrow-up"></i> {% elseif sort == 'ndate' %}<i class="fas fa-arrow-down"></i> {% endif %} </th>
								<th style="width: 75px;">Actions</th>
							</tr>
						</thead>
						<tbody>
							{% for Log in Logs %}
								<tr class="log" id="row{{Log.status}}">
									<td id="steamID" value="{{Log.status|e }}">{{ Log.url|e }}</td>
									<td id="steamKey" value="{{Log.status}}">{% if Log.content is not null and Log.content['SteamID'] is defined %} {{  Log.content['SteamID']|e }} {% endif %}</td>
									<td id="description">{% if Log.content is not null %} {{ Log.contentToString() }} {% endif %}</td>
									<td>{{ Log.timestamp|date("d/m/Y H:i:s") }}</td>
									<td class="text-end">
										<button class="btn btn-primary" onclick="openFormModify('{{Log.status}}')" type="button" style="background: #414141;border-color: #5e5e5e;margin-right: 15px;">
											<i class="fas fa-pencil-alt"></i>
										</button>
									</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
				<div class="row">
					<div class="col-md-6 align-self-center">
						<p id="dataTable_info" class="dataTables_info" role="status" aria-live="polite">Affichage de {{ ( page * size ) - 50 + 1}} à {{page * size}} sur {{ logCount }}</p>
					</div>
					<div class="col-md-6">
						<nav class="d-lg-flex justify-content-lg-end dataTables_paginate paging_simple_numbers">
							<ul class="pagination">
								<li class="page-item {% if page == 1 %} disabled {% endif %}"><a class="page-link" href="/log/{{ page - 1 }}/{{ sort }}" aria-label="Previous"><span aria-hidden="true">«</span></a></li>
								{% if page > 2 %}<li class="page-item"><a class="page-link" href="/log/{{ page - 2 }}/{{ sort }}">{{ page - 2}}</a></li>{% endif %}
								{% if page > 1 %}<li class="page-item"><a class="page-link" href="/log/{{ page - 1 }}/{{ sort }}">{{ page - 1}}</a></li>{% endif %}
								<li class="page-item active"><a class="page-link" href="/log/{{ 1 }}/{{ sort }}">{{ page }}</a></li>
								{% if logCount > ((page + 1) * size) - (size) %}<li class="page-item"><a class="page-link" href="/log/{{ page + 1 }}/{{ sort }}">{{ page + 1}}</a></li>{% endif %}
								{% if logCount > ((page + 2) * size) - (size) %}<li class="page-item"><a class="page-link" href="/log/{{ page + 2 }}/{{ sort }}">{{ page + 2}}</a></li>{% endif %}
								<li class="page-item {% if logCount <= ((page + 1) * size) - (size) %} disabled {% endif %}"><a class="page-link" href="/log/{{ page + 1 }}/{{ sort }}" aria-label="Next"><span aria-hidden="true">»</span></a></li>
							</ul>
						</nav>
					</div>
				</div>
			</div>
		</div>

	</div>

{% endblock %}
